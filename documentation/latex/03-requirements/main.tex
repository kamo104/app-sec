% Component Requirements - Functional and non-functional requirements
\section{Component Requirements}

\subsection{Functional Requirements}

\subsubsection{FR-1: User Registration}

\textbf{ID}: FR-1

\textbf{Description}: The system must allow a new user to register with username, email, and password.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item The frontend provides a registration form with real-time validation.
  \item Username must be 3--20 characters, printable UTF-8 only.
  \item Email must be valid format.
  \item Password must be 8--64 characters with uppercase, lowercase, digit, and special character.
  \item Returns specific error codes for duplicate username/email and validation failures.
\end{itemize}

\subsubsection{FR-2: Email Verification}

\textbf{ID}: FR-2

\textbf{Description}: The system must require email verification before the account is active.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item On successful registration, a secure verification token is generated.
  \item Token hash is stored in database (plaintext never stored).
  \item Verification email sent via SMTP with verification link.
  \item Token has configurable expiry.
  \item Verification endpoint validates token and marks user as verified.
  \item Token is deleted after successful verification.
\end{itemize}

\subsubsection{FR-3: Input Validation}

\textbf{ID}: FR-3

\textbf{Description}: All registration inputs must be validated on both frontend and backend.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item Shared validation logic compiled to WASM for frontend use.
  \item Username: 3--20 characters, printable UTF-8.
  \item Email: Valid format.
  \item Password: 8--64 characters with complexity requirements.
  \item Password strength score calculated with visual indicator.
  \item Validation errors translated to user-friendly messages.
\end{itemize}

\subsubsection{FR-4: Error Handling}

\textbf{ID}: FR-4

\textbf{Description}: The system must provide clear, translated error messages.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item Error responses use typed error codes.
  \item Validation errors include field-specific error codes.
  \item All error codes translated with localization support.
  \item Server errors logged internally; clients receive generic error.
\end{itemize}

\subsubsection{FR-5: Token Lifecycle}

\textbf{ID}: FR-5

\textbf{Description}: Verification tokens must be single-use and time-limited.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item Each user can have only one active verification token.
  \item Tokens expire after configurable duration.
  \item Expired tokens are automatically cleaned up.
  \item Unverified users with expired tokens are deleted.
  \item Token is deleted upon successful verification.
\end{itemize}

\subsection{Non-Functional Requirements}

\subsubsection{NFR-1: Security}

\textbf{ID}: NFR-1

\textbf{Description}: All security best practices must be followed.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item Passwords hashed with memory-hard algorithm.
  \item Verification tokens stored as hashes only.
  \item Database encrypted at rest.
  \item HTTPS enforced in production.
  \item Input validated on both frontend and backend.
\end{itemize}

\subsubsection{NFR-2: Reliability}

\textbf{ID}: NFR-2

\textbf{Description}: The module must be fault-tolerant.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item On email sending failure, user record is rolled back.
  \item Foreign keys ensure referential integrity.
  \item Automatic cleanup of expired tokens.
\end{itemize}

\subsubsection{NFR-3: Usability}

\textbf{ID}: NFR-3

\textbf{Description}: The module must provide clear user feedback.

\textbf{Details}:
\begin{itemize}[leftmargin=*,nosep]
  \item Real-time field validation on frontend.
  \item Password strength indicator.
  \item Translated error messages for all validation failures.
  \item Clear success/error states on all pages.
\end{itemize}
