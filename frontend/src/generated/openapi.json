{"openapi":"3.1.0","info":{"title":"AppSec Demo API","description":"Web app demonstration focused on using good web security practices","version":"1.0.0"},"paths":{"/api/auth/check":{"get":{"tags":["auth"],"operationId":"auth_check","responses":{"200":{"description":"Session is valid","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseData"}}}},"401":{"description":"Not authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthErrorResponse"}}}}}}},"/api/auth/refresh":{"post":{"tags":["auth"],"operationId":"refresh_session","responses":{"200":{"description":"Session refreshed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseData"}}}},"401":{"description":"Not authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthErrorResponse"}}}}}}},"/api/complete-password-reset":{"post":{"tags":["auth"],"operationId":"complete_password_reset","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetCompleteRequest"}}},"required":true},"responses":{"200":{"description":"Password reset completed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompletePasswordResetResponse"}}}},"400":{"description":"Invalid token or validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompletePasswordResetErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompletePasswordResetErrorResponse"}}}}}}},"/api/counter/get":{"get":{"tags":["counter"],"operationId":"get_counter","responses":{"200":{"description":"Counter value retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CounterData"}}}},"401":{"description":"Not authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CounterErrorResponse"}}}}}}},"/api/counter/set":{"post":{"tags":["counter"],"operationId":"set_counter","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetCounterRequest"}}},"required":true},"responses":{"200":{"description":"Counter value updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CounterData"}}}},"401":{"description":"Not authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CounterErrorResponse"}}}}}}},"/api/health":{"get":{"tags":["health"],"operationId":"health_check","responses":{"200":{"description":"Health check successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/api/login":{"post":{"tags":["auth"],"operationId":"login_user","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponseData"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginErrorResponse"}}}},"401":{"description":"Invalid credentials or email not verified","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginErrorResponse"}}}}}}},"/api/logout":{"post":{"tags":["auth"],"operationId":"logout_user","responses":{"200":{"description":"Logged out successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutResponse"}}}}}}},"/api/register":{"post":{"tags":["auth"],"operationId":"register_user","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegistrationRequest"}}},"required":true},"responses":{"200":{"description":"User registered successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterResponse"}}}},"400":{"description":"Validation error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterErrorResponse"}}}},"409":{"description":"Username or email already taken","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterErrorResponse"}}}}}}},"/api/request-password-reset":{"post":{"tags":["auth"],"operationId":"request_password_reset","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetRequest"}}},"required":true},"responses":{"200":{"description":"Password reset requested (always returns success for security)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestPasswordResetResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestPasswordResetErrorResponse"}}}}}}},"/api/verify-email":{"post":{"tags":["auth"],"operationId":"verify_email","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailVerificationRequest"}}},"required":true},"responses":{"200":{"description":"Email verified successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyEmailResponse"}}}},"400":{"description":"Invalid or expired token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyEmailErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyEmailErrorResponse"}}}}}}}},"components":{"schemas":{"AuthError":{"type":"string","description":"Error codes for auth check and refresh endpoints.","enum":["INVALID_CREDENTIALS","INTERNAL"]},"AuthErrorResponse":{"type":"object","description":"Auth error response (used for auth check and refresh).","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/AuthError"}}},"CompletePasswordResetError":{"type":"string","description":"Error codes specific to password reset completion endpoint.","enum":["INVALID_TOKEN","VALIDATION","INTERNAL"]},"CompletePasswordResetErrorResponse":{"type":"object","description":"Password reset completion error response.","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/CompletePasswordResetError"},"validation":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/ValidationErrorData"}]}}},"CompletePasswordResetResponse":{"type":"object","description":"Password reset completion success response.","required":["success"],"properties":{"success":{"$ref":"#/components/schemas/CompletePasswordResetSuccess"}}},"CompletePasswordResetSuccess":{"type":"string","description":"Success code for password reset completion endpoint.","enum":["SUCCESS_PASSWORD_RESET_COMPLETED"]},"CounterData":{"type":"object","description":"Counter data containing the current counter value.","required":["value"],"properties":{"value":{"type":"integer","format":"int64"}}},"CounterError":{"type":"string","description":"Error codes for counter endpoints.","enum":["INTERNAL"]},"CounterErrorResponse":{"type":"object","description":"Counter error response (for internal server errors).","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/CounterError"}}},"EmailVerificationRequest":{"type":"object","description":"Email verification request payload.","required":["token"],"properties":{"token":{"type":"string"}}},"FieldType":{"type":"string","description":"Field types for validation errors.","enum":["UNSPECIFIED","USERNAME","EMAIL","PASSWORD"]},"HealthResponse":{"type":"object","description":"Health check response.","required":["success"],"properties":{"success":{"$ref":"#/components/schemas/HealthSuccess"}}},"HealthSuccess":{"type":"string","description":"Success code for health check endpoint.","enum":["SUCCESS_OK"]},"LoginError":{"type":"string","description":"Error codes specific to login endpoint.","enum":["INVALID_CREDENTIALS","EMAIL_NOT_VERIFIED","VALIDATION","INTERNAL"]},"LoginErrorResponse":{"type":"object","description":"Login error response.","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/LoginError"},"validation":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/ValidationErrorData"}]}}},"LoginRequest":{"type":"object","description":"Login request payload.","required":["username","password"],"properties":{"password":{"type":"string"},"username":{"type":"string"}}},"LoginResponseData":{"type":"object","description":"Login response data containing user info and session details.","required":["username","email","sessionExpiresAt","sessionCreatedAt"],"properties":{"email":{"type":"string"},"sessionCreatedAt":{"type":"integer","format":"int64","description":"Unix timestamp in seconds when the session was created."},"sessionExpiresAt":{"type":"integer","format":"int64","description":"Unix timestamp in seconds when the session expires."},"username":{"type":"string"}}},"LogoutResponse":{"type":"object","description":"Logout success response.","required":["success"],"properties":{"success":{"$ref":"#/components/schemas/LogoutSuccess"}}},"LogoutSuccess":{"type":"string","description":"Success code for logout endpoint.","enum":["SUCCESS_LOGGED_OUT"]},"PasswordResetCompleteRequest":{"type":"object","description":"Password reset completion request payload.","required":["token","newPassword"],"properties":{"newPassword":{"type":"string"},"token":{"type":"string"}}},"PasswordResetRequest":{"type":"object","description":"Password reset request payload (initial step).","required":["email"],"properties":{"email":{"type":"string"}}},"RegisterError":{"type":"string","description":"Error codes specific to registration endpoint.","enum":["USERNAME_TAKEN","EMAIL_TAKEN","VALIDATION","INTERNAL"]},"RegisterErrorResponse":{"type":"object","description":"Registration error response.","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/RegisterError"},"validation":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/ValidationErrorData"}]}}},"RegisterResponse":{"type":"object","description":"Registration success response.","required":["success"],"properties":{"success":{"$ref":"#/components/schemas/RegisterSuccess"}}},"RegisterSuccess":{"type":"string","description":"Success code for registration endpoint.","enum":["SUCCESS_REGISTERED"]},"RegistrationRequest":{"type":"object","description":"Registration request payload.","required":["username","email","password"],"properties":{"email":{"type":"string"},"password":{"type":"string"},"username":{"type":"string"}}},"RequestPasswordResetError":{"type":"string","description":"Error codes for password reset request endpoint.","enum":["INTERNAL"]},"RequestPasswordResetErrorResponse":{"type":"object","description":"Password reset request error response.","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/RequestPasswordResetError"}}},"RequestPasswordResetResponse":{"type":"object","description":"Password reset request success response.","required":["success"],"properties":{"success":{"$ref":"#/components/schemas/RequestPasswordResetSuccess"}}},"RequestPasswordResetSuccess":{"type":"string","description":"Success code for password reset request endpoint.","enum":["SUCCESS_PASSWORD_RESET_REQUESTED"]},"SetCounterRequest":{"type":"object","description":"Set counter request payload.","required":["value"],"properties":{"value":{"type":"integer","format":"int64"}}},"ValidationErrorCode":{"type":"string","description":"Validation error codes.","enum":["UNSPECIFIED","REQUIRED","TOO_SHORT","TOO_LONG","INVALID_CHARACTERS","INVALID_FORMAT","TOO_FEW_UPPERCASE_LETTERS","TOO_FEW_LOWERCASE_LETTERS","TOO_FEW_DIGITS","TOO_FEW_SPECIAL_CHARACTERS"]},"ValidationErrorData":{"type":"object","description":"Validation error data containing multiple field errors.","required":["fieldErrors"],"properties":{"fieldErrors":{"type":"array","items":{"$ref":"#/components/schemas/ValidationFieldError"}}}},"ValidationFieldError":{"type":"object","description":"Validation error for a single field.","required":["field","errors"],"properties":{"errors":{"type":"array","items":{"$ref":"#/components/schemas/ValidationErrorCode"}},"field":{"$ref":"#/components/schemas/FieldType"}}},"VerifyEmailError":{"type":"string","description":"Error codes specific to email verification endpoint.","enum":["INVALID_TOKEN","INTERNAL"]},"VerifyEmailErrorResponse":{"type":"object","description":"Email verification error response.","required":["error"],"properties":{"error":{"$ref":"#/components/schemas/VerifyEmailError"}}},"VerifyEmailResponse":{"type":"object","description":"Email verification success response.","required":["success"],"properties":{"success":{"$ref":"#/components/schemas/VerifyEmailSuccess"}}},"VerifyEmailSuccess":{"type":"string","description":"Success code for email verification endpoint.","enum":["SUCCESS_EMAIL_VERIFIED"]}}}}